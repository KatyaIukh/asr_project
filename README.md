# Fine-tuning Whisper with LoRA for Upper Sorbian Speech Recognition

## –û –ø—Ä–æ–µ–∫—Ç–µ

–î–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ –¥–æ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ Whisper —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoRA –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –Ω–∞ –Ω–∏–∑–∫–æ—Ä–µ—Å—É—Ä—Å–Ω–æ–º —è–∑—ã–∫–µ. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–∏–π —è–∑—ã–∫.

**–í–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–∏–π** ‚Äì –æ–¥–∏–Ω –∏–∑ –¥–≤—É—Ö —è–∑—ã–∫–æ–≤ –ª—É–∂–∏—á–∞–Ω, —Å–ª–∞–≤—è–Ω—Å–∫–æ–≥–æ –Ω–∞—Ä–æ–¥–∞, –ø—Ä–æ–∂–∏–≤–∞—é—â–µ–≥–æ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –õ—É–∂–∏—Ü—ã –≤ –ì–µ—Ä–º–∞–Ω–∏–∏. –î–∞–Ω–Ω—ã–π —è–∑—ã–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –Ω–∞–±–æ—Ä–æ–≤ Common Voice, –æ–¥–Ω–∞–∫–æ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ —Å—É–º–º–∞—Ä–Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –≤—Å–µ–≥–æ 4 —á–∞—Å–∞ —Ä–µ—á–∏, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –¥–æ–æ–±—É—á–µ–Ω–∏—è. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –¥–∞–Ω–Ω—ã–π —è–∑—ã–∫ –±—ã–ª –≤—ã–±—Ä–∞–Ω –∫–∞–∫ –ø—Ä–∏–º–µ—Ä –≤ —Ä–∞–±–æ—Ç–µ, –ø–æ—Å–≤—è—â—ë–Ω–Ω–æ–π –Ω–∏–∑–∫–æ—Ä–µ—Å—É—Ä—Å–Ω—ã–º —è–∑—ã–∫–∞–º.

## –ü–æ–¥—Ö–æ–¥—ã –∫ –¥–æ–æ–±—É—á–µ–Ω–∏—é

–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ –¥–æ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ Whisper-small –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–≥–æ —è–∑—ã–∫–∞:

### 1. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥
–î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–Ω–æ–ª–∏–Ω–≥–≤–∞–ª—å–Ω–æ–≥–æ LoRA –∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ —Ü–µ–ª–µ–≤–æ–º —è–∑—ã–∫–µ (–≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–º).

### 2. –î–≤—É—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
–í –¥–∞–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –±–ª–∏–∑–∫–æ–º –∫ —Ü–µ–ª–µ–≤–æ–º—É, –Ω–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ—Ä–µ—Å—É—Ä—Å–Ω–æ–º —è–∑—ã–∫–µ (—á–µ—à—Å–∫–∏–π).

**–≠—Ç–∞–ø—ã –¥–≤—É—ç—Ç–∞–ø–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
- –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –æ–±—É—á–∞–µ—Ç—Å—è –º–æ–Ω–æ–ª–∏–Ω–≥–≤–∞–ª—å–Ω—ã–π –∞–¥–∞–ø—Ç–µ—Ä –Ω–∞ —á–µ—à—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ `merge_and_unload` –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PeftModel –≤–µ—Å–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —Å –∏—Å—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª—å—é Whisper
- –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∑–∞–ø–∞–¥–Ω–æ—Å–ª–∞–≤—è–Ω—Å–∫–∏—Ö —è–∑—ã–∫–æ–≤
- –ù–∞ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–ø–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ LoRA –∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–∞ –º–æ–Ω–æ—è–∑—ã—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–≥–æ —è–∑—ã–∫–∞
  
<img width="700" alt="–°–Ω–∏–º–æ–∫ —ç–∫—Ä–∞–Ω–∞ (3082)" src="https://github.com/user-attachments/assets/ec2a9ebf-7a9d-4e0b-90fd-90294d86ec93" />


## –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

- **–ß–µ—à—Å–∫–∏–π —è–∑—ã–∫**: ~9.43 —á–∞—Å–æ–≤ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö
- **–í–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–∏–π —è–∑—ã–∫**: ~4 —á–∞—Å–æ–≤ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö
- –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: JSON —Ñ–∞–π–ª—ã —Å –ø—É—Ç—è–º–∏ –∫ MP3 —Ñ–∞–π–ª–∞–º –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è–º–∏

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ß–µ—à—Å–∫–∏–π –∞–¥–∞–ø—Ç–µ—Ä | –í–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–∏–π –∞–¥–∞–ø—Ç–µ—Ä |
|----------|------------------|------------------------|
| **Batch size** | 8 | 8 |
| **Learning rate** | 1e-3 | 1e-3 |
| **–≠–ø–æ—Ö–∏** | 3 | 3 |
| **LoRA rank (r)** | 32 | 32 |
| **LoRA alpha** | 64 | 64 |

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º LoRa –∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–º —è–∑—ã–∫–µ:
<img width="500" alt="image" src="https://github.com/user-attachments/assets/f87dc576-798f-4704-967f-54eccd06a488" />

–í–∏–¥–Ω–æ, —á—Ç–æ –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π WER –æ–±—É—Å–ª–æ–≤–ª–µ–Ω —Ä–µ–¥–∫–∏–º–∏ –≤—ã–±—Ä–æ—Å–∞–º–∏, –≤ —Ü–µ–ª–æ–º –º–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫—É—é —Ä–µ—á—å, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–∞–ª–∏—á–∏–µ–º —Å–ª–∞–≤—è–Ω—Å–∫–∏—Ö —è–∑—ã–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ whisper, –æ–¥–Ω–∞–∫–æ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è –Ω–µ–≤—ã—Å–æ–∫–æ

–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏, –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ –¥–æ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–º:

<img width="500" alt="wer_distribution" src="https://github.com/user-attachments/assets/dc716038-ec2d-4e2f-931c-81c1c59e0fa2" />

–ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã, –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è —Ä–µ—á–∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ª—É—á—à–∏–ª–æ—Å—å
–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –æ–±—ã—á–Ω–æ –ø—Ä–∏ –¥–æ–æ–±—É—á–µ–Ω–∏–∏ ASR –º–æ–¥–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞–∑—ã –±–æ–ª—å—à–µ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö, —á–µ–º 10 —á–∞—Å–æ–≤ –∞—É–¥–∏–æ, —Å–∫–æ–ª—å–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ –≤ –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ, —Ç–∞–∫ —á—Ç–æ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–∂–µ –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ –≤—ã—Å–æ–∫–æ—Ä–µ—Å—É—Ä—Å–Ω—ã–º "—è–∑—ã–∫–æ–º-–ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º" –ø—Ä–∏ –¥–æ–æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è —Ä–µ—á–∏ –Ω–∞ –Ω–∏–∑–∫–æ—Ä–µ—Å—É—Ä—Å–Ω—ã–µ —è–∑—ã–∫–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

### üîß –ö–æ–¥ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **`json_from_common.ipynb`** - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ –∞—Ä—Ö–∏–≤–∞ Common Voice –≤ JSON

### üìÅ –î–∞–Ω–Ω—ã–µ
- **`sorbian_train.json`** - —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–º —è–∑—ã–∫–µ –∏–∑ Common Voice
- **`sorbian_val.json`** - –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–º —è–∑—ã–∫–µ –∏–∑ Common Voice

### üöÄ –ö–æ–¥ –æ–±—É—á–µ–Ω–∏—è –∞–¥–∞–ø—Ç–µ—Ä–æ–≤
- **`base_adapter_train.py`** - –æ–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ —á–µ—à—Å–∫–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞
- **`hsb_adapter.py`** - –æ–±—É—á–µ–Ω–∏–µ –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥)
- **`cz_hsb_adapter.py`** - –æ–±—É—á–µ–Ω–∏–µ –≤–µ—Ä—Ö–Ω–µ–ª—É–∂–∏—Ü–∫–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —á–µ—à—Å–∫–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ (–¥–≤—É—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥)

### üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **`README.md`** - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ 
